# Lambda Web Application
A sample web application and its IaC automation for demonstrating a serverless web application
This Project also demonstrates how Github actions enables CICD to automate build and deployment of an IaC Code .
Here we set up a complete GitHub Actions workflow to deploy a publicly accessible serverless web app within a Terraform Cloud workspace.
The workflow will:
  - check whether the configuration is formatted properly to demonstrate how you can enforce best practices

  - generate a plan for every pull requests
  - apply the configuration when you push the code to the main/develop branch
we can test the work flow by raising a merge/pull request to main/develop branch

This project will deploy following AWS services
  1. A Lambda function which prints the request header, method, and body
  2. Role and policy for AWS Lambda function
  3. An API Gateway which integrated with the Lambda function

This  project architecture demonstrates how to use AWS Lambda in conjunction with Amazon API Gateway, Amazon DynamoDB to build a serverless web application.
This project also has a .github directory which defines a workflow to build and deploy the terraform code

## Pre- Requisites
 - An AWS Account with user credentials with permission to deploy AWS resources ( E.g.: Attach role: Administrator)
 - configure Terraform to reference your AWS account
 - A Github/GitLab account reference your AWS account
 - Secret variables added for AWS credentials ,Please refer[this page](https://docs.github.com/en/actions/security-guides/encrypted-secrets)


## Features

- .github/workflows/terraform.yml defines a deployment workflow for the project
- .gitlab.yaml defines a gitlab build and deployment pipeline for the project

For details about gitlab pipeline setup

##Developer workflow
####1. Clone project:
    ```shell script
    git clone https://github.com/jomcy-amzn/wm-serverlesslambda.git
    ```
####2.Create branch with your feature:
   ```shell script
    git checkout -b develop
  ```
- Update `state.tf` file in the project root folder to select your backend as http or s3
- Update  `dev.config` file in backend-configs/ folder to set Amazons3 backend details
- The Github work flow is designed with 3 stages(jobs) : Terraform Plan , Terraform Apply and Terraform destroy

####3. Write/update the code. Commit and push changes:
   ```shell script
   git commit -am "My feature is ready"
   git push
   ```
####4. validate the Github action
 - The push will trigger the github actions,
   Successful completion of terraform-apply stage will output the URL to test
 - For clean-up, trigger the Terraform destroy job in the pipeline

####5. Review your code on commits page.

####6. Create a merge request from develop to main branch.

####7. Let our team lead reviews the code and merges it to the main branch.


## Details
This session is autogenerated by terraform-docs

<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_archive"></a> [archive](#requirement\_archive) | 2.2.0 |
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | 3.74.0 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_aws"></a> [aws](#provider\_aws) | 3.74.0 |

## Modules


| Name | Source | Version |
|------|--------|---------|
| <a name="module_wm-apigw"></a> [wm-apigw](#module\_wm-apigw) | ./modules/api-gateway | n/a |
| <a name="module_wm-lambda"></a> [wm-lambda](#module\_wm-lambda) | ./modules/lambda | n/a |


## Resources

| Name | Type |
|------|------|
| [aws_caller_identity.current](https://registry.terraform.io/providers/hashicorp/aws/3.74.0/docs/data-sources/caller_identity) | data source |
| [aws_partition.current](https://registry.terraform.io/providers/hashicorp/aws/3.74.0/docs/data-sources/partition) | data source |
| [aws_region.current](https://registry.terraform.io/providers/hashicorp/aws/3.74.0/docs/data-sources/region) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_apigw_name"></a> [apigw\_name](#input\_apigw\_name) | Name of Api gateway | `string` | `"my_lambda_api_gateway"` | no |
| <a name="input_lambda_name"></a> [lambda\_name](#input\_lambda\_name) | Name of Lambda function | `string` | `"my_lambda_function"` | no |
| <a name="input_region"></a> [region](#input\_region) | Region for deploying infrastructure | `string` | `"us-west-2"` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_wm_read_url"></a> [wm\_read\_url](#output\_wm\_read\_url) | n/a |
<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
